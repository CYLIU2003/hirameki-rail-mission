<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>救援列車ミッション | Kiosk</title>
  <link rel="stylesheet" href="/common.css"/>
</head>
<body>
  <div class="confettiOverlay" id="confetti"></div>

  <div class="container">
    <div class="row" style="justify-content:space-between; align-items:flex-end;">
      <div class="kidHeader">
        <img src="/assets/mascot.svg" alt="">
        <div>
          <div class="h1">救援列車ミッション</div>
          <div class="kidHint" id="kidModeLabel">（キッズモード）</div>
        </div>
      </div>
      <div class="badge" id="connBadge">接続中…</div>
    </div>

    <div class="row" style="margin-top:12px;">
      <span class="badge" id="badgeKiosk"></span>
      <span class="badge" id="badgeInput"></span>
      <span class="badge" id="badgeMode"></span>
      <span class="badge" id="badgeDifficulty"></span>
    </div>

    <!-- ATTRACT -->
    <section id="S_ATTRACT" class="card" style="margin-top:14px;">
      <div class="h2">①カード番号を入れる（または ルーレット）</div>
      <div class="p">カードを引いたら番号（01〜30）を入力。なければ「ルーレット開始」でOK！</div>

      <div class="grid" style="grid-template-columns: 1fr 1fr; margin-top:12px;">
        <div class="card">
          <div class="h2">カード番号</div>
          <input class="input" id="cardInput" inputmode="numeric" maxlength="2" placeholder="01〜30"/>
          <div class="row" style="margin-top:10px;">
            <button class="btn" id="btnCardClear">クリア</button>
            <button class="btn primary" id="btnStartWithId">この番号で開始</button>
          </div>
          <div class="muted" style="margin-top:8px;">例：03 / 12</div>
        </div>

        <div class="card">
          <div class="h2">②レベルをえらぶ</div>
          <div class="grid" style="grid-template-columns: 1fr 1fr; gap:10px;">
            <div>
              <div class="muted">難易度</div>
              <select class="select" id="selDifficulty">
                <option value="EASY">EASY（おすすめ）</option>
                <option value="NORMAL" selected>NORMAL</option>
                <option value="HARD">HARD（むずかしい）</option>
              </select>
            </div>
            <div>
              <div class="muted">モード</div>
              <select class="select" id="selMode">
                <option value="NORMAL" selected>NORMAL（10）</option>
                <option value="QUICK">QUICK（5）</option>
              </select>
            </div>
          </div>

          <div class="row" style="margin-top:10px;">
            <button class="btn primary big" id="btnStartDeck">ルーレット開始（被りにくい）</button>
            <button class="btn danger" id="btnForceReset">強制リセット</button>
          </div>

          <div class="noteBox" style="margin-top:10px;">
            ③作戦をえらぶ → ④しゅっぱつ！<br/>
            （マウス：<span class="kbd">Enter</span> しゅっぱつ / <span class="kbd">R</span> リセット）
          </div>
        </div>
      </div>
    </section>

    <!-- BRIEFING -->
    <section id="S_BRIEFING" class="card hidden" style="margin-top:14px;">
      <div class="h2" id="briefTitle">ミッション</div>
      <div class="p" id="briefText"></div>
      <div class="faceRow" id="briefFaces"></div>
      <hr/>
      <div class="grid" style="grid-template-columns: 1fr 1fr; gap:14px;">
        <div>
          <div class="muted">もくひょう</div>
          <div class="p" id="briefObjective"></div>
          <div style="margin-top:10px;">
            <span class="badge warn">ヒント</span>
            <span class="muted" id="briefHint"></span>
          </div>
        </div>
        <div>
          <div class="muted">ちゅうい（しばり）</div>
          <ul id="briefConstraints" style="margin:8px 0 0 18px; color:var(--muted); font-size:16px; line-height:1.55;"></ul>
        </div>
      </div>
      <div class="row" style="margin-top:14px; justify-content:flex-end;">
        <button class="btn" id="btnBackToAttract">もどる</button>
        <button class="btn primary big" id="btnToPlanning">③作戦をえらぶ</button>
      </div>
    </section>

    <!-- PLANNING (Kid Mode) -->
    <section id="S_PLANNING_KID" class="card hidden" style="margin-top:14px;">
      <div class="h2">③作戦をえらぼう（2つまで）</div>
      <div class="muted">おもしろポイント：2つえらぶと“コンボ”っぽくなる！</div>

      <div class="actionGrid" id="kidActionGrid"></div>

      <div class="card" style="margin-top:12px;">
        <div class="h2">いまのスコア</div>
        <div class="muted">顔がニコニコ（🙂）になるようにしよう！</div>

        <div class="faceRow" id="planFaces"></div>

        <div class="progressWrap" style="margin-top:10px;">
          <div class="progressRow">
            <div class="progressLabel">たすけ</div>
            <div class="progressBar"><div class="progressFill" id="kiosk_rescue_fill"></div></div>
            <div class="progressValue" id="kiosk_rescue_val"></div>
          </div>
          <div class="progressRow">
            <div class="progressLabel">こんざつ</div>
            <div class="progressBar"><div class="progressFill" id="kiosk_crowd_fill"></div></div>
            <div class="progressValue" id="kiosk_crowd_val"></div>
          </div>
          <div class="progressRow">
            <div class="progressLabel">おくれ</div>
            <div class="progressBar"><div class="progressFill" id="kiosk_delay_fill"></div></div>
            <div class="progressValue" id="kiosk_delay_val"></div>
          </div>
        </div>
      </div>

      <div class="row" style="margin-top:14px; justify-content:flex-end;">
        <button class="btn" id="btnPlanningBackKid">もどる</button>
        <button class="btn primary big" id="btnToReadyKid">④しゅっぱつじゅんび</button>
      </div>
    </section>

    <!-- READY -->
    <section id="S_READY" class="card hidden" style="margin-top:14px;">
      <div class="h2">④しゅっぱつ！</div>
      <div class="p">ボタンをおすと、3・2・1…で発車するよ。</div>
      <div class="countdown small" id="countHint">（ボタンをおしてね）</div>
      <div class="center" style="margin-top:12px;">
        <button class="btn primary big" id="btnDepart">しゅっぱつ（Enter）</button>
      </div>
      <div class="row" style="margin-top:14px; justify-content:flex-end;">
        <button class="btn" id="btnReadyBack">作戦をなおす</button>
      </div>
    </section>

    <!-- RUNNING -->
    <section id="S_RUNNING" class="card hidden" style="margin-top:14px;">
      <div class="h2">うごかしてるよ…</div>
      <div class="muted">発車標が切りかわる！みててね！</div>
      <div class="countdown" id="runCount">🚆</div>

      <div class="progressWrap" style="margin-top:12px;">
        <div class="progressRow">
          <div class="progressLabel">たすけ</div>
          <div class="progressBar"><div class="progressFill" id="run_rescue_fill"></div></div>
          <div class="progressValue" id="run_rescue_val"></div>
        </div>
        <div class="progressRow">
          <div class="progressLabel">こんざつ</div>
          <div class="progressBar"><div class="progressFill" id="run_crowd_fill"></div></div>
          <div class="progressValue" id="run_crowd_val"></div>
        </div>
        <div class="progressRow">
          <div class="progressLabel">おくれ</div>
          <div class="progressBar"><div class="progressFill" id="run_delay_fill"></div></div>
          <div class="progressValue" id="run_delay_val"></div>
        </div>
      </div>
      <div class="muted" style="margin-top:10px;">ステップ：<span id="runStep">0</span>/<span id="runTotal">10</span></div>
    </section>

    <!-- RESULT -->
    <section id="S_RESULT" class="card hidden" style="margin-top:14px;">
      <div class="h2" id="resultTitle">結果</div>
      <div class="p" id="resultReason"></div>
      <div class="row" style="margin-top:10px;">
        <span class="badge good" id="resultBadgeTotal">総合 0</span>
        <span class="badge" id="resultBadgeName">称号：-</span>
        <span class="badge" id="resultBadgeCode">コード：----</span>
      </div>

      <div class="faceRow" id="resultFaces"></div>

      <div class="row" style="margin-top:14px; justify-content:flex-end;">
        <button class="btn" id="btnRetry">もう一回（作戦をかえる）</button>
        <button class="btn primary big" id="btnShowCert">証明書へ</button>
      </div>
    </section>

    <!-- CERT -->
    <section id="S_CERT" class="card hidden" style="margin-top:14px;">
      <div class="h2">復旧証明書（写真OK）</div>
      <div class="card" style="margin-top:12px; border-radius:22px; position:relative; overflow:hidden;">
        <img src="/assets/pattern.svg" alt="" style="position:absolute; inset:0; opacity:0.18; width:100%; height:100%; object-fit:cover;">
        <div style="position:relative;">
          <div class="h1" style="margin:0; display:flex; align-items:center; gap:12px;">
            <img src="/assets/star.svg" style="width:44px;height:44px;" alt="">
            ★ 運行復旧 証明書 ★
          </div>
          <div class="muted" id="certWhen"></div>
          <hr/>
          <div class="grid" style="grid-template-columns: 1fr 1fr; gap:14px;">
            <div>
              <div class="muted">ミッション</div>
              <div class="p" id="certMission"></div>
              <div class="muted" style="margin-top:10px;">称号</div>
              <div class="h2" id="certTitle"></div>
            </div>
            <div>
              <div class="muted">コード（ランキング用）</div>
              <div class="h1" id="certCode" style="letter-spacing:4px;"></div>
              <div class="muted">スコア（たすけ/こんざつ/おくれ）</div>
              <div class="p" id="certScores"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="row" style="margin-top:14px; justify-content:flex-end;">
        <button class="btn primary big" id="btnNext">次の人へ（リセット）</button>
      </div>
    </section>
  </div>

  <script src="/catalog.js"></script>
  <script src="/common.js"></script>
  <script src="/kiosk.js"></script>
</body>
</html>
